<ion-header>
  <ion-toolbar>
    <ion-title>Perfil</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="perfil-content" [class.loading]="loading">
  
  <!-- Avatar y información principal -->
  <div class="profile-header">
    <div class="avatar-container">
      <div class="avatar" [style.background]="getAvatarColor()">
        {{ getUserInitials() }}
      </div>
      <ion-button fill="clear" class="edit-avatar-btn" size="small">
        <ion-icon name="camera-outline"></ion-icon>
      </ion-button>
    </div>
    
    <div class="user-info">
      <h1>{{ user?.name || 'Usuario' }}</h1>
      <p class="role">{{ user?.role || 'Camarero/a' }}</p>
      <p class="location" *ngIf="user?.location">
        <ion-icon name="location-outline"></ion-icon>
        {{ user?.location }}
      </p>
    </div>
  </div>

  <!-- Estadísticas principales -->
<div class="stats-section">
  <div class="stat-card">
    <div class="stat-icon earning">€</div>
    <div class="stat-details">
      <h3>Total ganado</h3>
      <p class="stat-value highlight-value">{{ formatCurrency(totalGanado) }}</p>
    </div>
  </div>

  <div class="stats-grid">
    <div class="stat-item">
      <div class="stat-label">Horas trabajadas</div>
      <div class="stat-number" data-suffix="h">{{ totalHoras }}</div>
    </div>
    
    <div class="stat-divider"></div>
    
    <div class="stat-item">
      <div class="stat-label">Turnos totales</div>
      <div class="stat-number">{{ totalTurnos }}</div>
    </div>
  </div>
</div>

  <!-- Información personal -->
  <div class="section">
    <h2 class="section-title">Información personal</h2>
    
    <ion-list lines="none" class="info-list">
      <ion-item>
        <ion-icon slot="start" name="mail-outline" color="medium"></ion-icon>
        <ion-label>
          <h3>Email</h3>
          <p>{{ user?.email || 'No especificado' }}</p>
        </ion-label>
      </ion-item>
      
      <ion-item (click)="editPhone()" class="editable">
        <ion-icon slot="start" name="call-outline" color="medium"></ion-icon>
        <ion-label>
          <h3>Teléfono</h3>
          <p>{{ user?.phone || 'Añadir teléfono' }}</p>
        </ion-label>
        <ion-icon slot="end" name="create-outline" color="medium"></ion-icon>
      </ion-item>
      
      <ion-item>
        <ion-icon slot="start" name="cash-outline" color="medium"></ion-icon>
        <ion-label>
          <h3>Tarifa por hora</h3>
          <p class="highlight">{{ formatCurrency(user?.hourlyRate || 0) }}/hora</p>
        </ion-label>
      </ion-item>
      
      <ion-item>
        <ion-icon slot="start" name="calendar-outline" color="medium"></ion-icon>
        <ion-label>
          <h3>Trabajando desde</h3>
          <p>{{ getWorkingMonths() }} meses</p>
        </ion-label>
      </ion-item>
    </ion-list>
  </div>

  <!-- Configuración -->
  <div class="section">
    <h2 class="section-title">Configuración</h2>
    
    <ion-list lines="none" class="settings-list">
      <ion-item button (click)="openNotifications()">
        <ion-icon slot="start" name="notifications-outline" color="medium"></ion-icon>
        <ion-label>Notificaciones</ion-label>
        <ion-toggle [checked]="notificationsEnabled" (ionChange)="toggleNotifications($event)"></ion-toggle>
      </ion-item>
      
      <ion-item button (click)="openSettings()">
        <ion-icon slot="start" name="settings-outline" color="medium"></ion-icon>
        <ion-label>Ajustes</ion-label>
        <ion-icon slot="end" name="chevron-forward-outline" color="medium"></ion-icon>
      </ion-item>
    </ion-list>
  </div>

  <!-- Más opciones -->
  <div class="section">
    <ion-list lines="none" class="options-list">
      <ion-item button (click)="openPrivacy()">
        <ion-icon slot="start" name="shield-outline" color="medium"></ion-icon>
        <ion-label>Privacidad y seguridad</ion-label>
        <ion-icon slot="end" name="chevron-forward-outline" color="medium"></ion-icon>
      </ion-item>
      
      <ion-item button (click)="openHelp()">
        <ion-icon slot="start" name="help-circle-outline" color="medium"></ion-icon>
        <ion-label>Ayuda y soporte</ion-label>
        <ion-icon slot="end" name="chevron-forward-outline" color="medium"></ion-icon>
      </ion-item>
    </ion-list>
  </div>

  <!-- Cerrar sesión -->
  <div class="logout-section">
    <ion-button expand="block" fill="clear" color="danger" (click)="logout()">
      <ion-icon slot="start" name="log-out-outline"></ion-icon>
      Cerrar sesión
    </ion-button>
  </div>

  <!-- Estado vacío cuando no hay usuario -->
  <div class="empty-state" *ngIf="!user && !loading">
    <ion-icon name="person-outline" class="empty-icon"></ion-icon>
    <h3>No hay usuario</h3>
    <p>Inicia sesión para ver tu perfil</p>
    <ion-button expand="block" routerLink="/login">
      Iniciar sesión
    </ion-button>
  </div>

  <!-- Spinner de carga -->
  <ion-spinner *ngIf="loading" class="center-spinner"></ion-spinner>
</ion-content>